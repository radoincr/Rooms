@rendermode InteractiveServer
@using Microsoft.AspNetCore.Components.Authorization
@inject NavigationManager Navigation
@using APIClassRoom.Components.Pages

<AuthorizeView>
    <Authorized>
        <NavLink class="btn btn-primary">
            <button @onclick="() => aiBotComponent.ShowIAAssistant()">AI Assistant</button>
        </NavLink>
        <div class="dropdown">
            <button class="btn btn-dark dropdown-toggle d-flex align-items-center"
                    type="button" data-bs-toggle="dropdown"
                    @onclick="ToggleDropdown">
                <div class="avatar-circle">
                    @context.User.Identity.Name?[0]
                </div>
            </button>
            <ul class="dropdown-menu dropdown-menu-end @(isDropdownOpen ? "show" : "")">
                <li class="dropdown-item">@context.User.Identity.Name</li>
                <form class="loginform" action="/Login/Logout" method="post">
                    <button type="submit" class="logout-button">
                        <i class='bx bx-door-open'></i>
                        Logout
                    </button>
                </form>
            </ul>
        </div>

    </Authorized>
    <NotAuthorized>
        <NavLink class="btn btn-outline-light" href="/login">Login</NavLink>
    </NotAuthorized>
    <NotAuthorized>
        <NavLink class="btn btn-outline-light" href="/login">Login</NavLink>
    </NotAuthorized>
</AuthorizeView>

<AIBot @ref="aiBotComponent"/>


<style>
    .avatar-circle {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background-color: #007bff;
        color: white;
        font-weight: bold;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
        margin-right: 10px;
    }
    
     .logout-button {
         background-color: #d9534f; /* Rouge */
         color: white;
         border: none;
         padding: 3px 20px;
         display: flex;
         align-items: center;
         gap: 8px;
         cursor: pointer;
         border-radius: 5px;
         font-size: 16px;
         font-weight: bold;
         transition: background-color 0.3s ease, transform 0.2s;
     }

    .logout-button:hover {
        background-color: #c9302c; /* Rouge plus foncé au survol */
        transform: scale(1.05);
    }

    .logout-button i {
        font-size: 20px;
    }
</style>